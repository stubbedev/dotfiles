#!/bin/bash
echo "This installs configs for TMUX, ZSH and NEOVIM as well as the SuckLess Terminal"
echo "Make sure all of these are installed in order for the configs to take effect."
read -rn 1 -p "Continue Installation y/N:" ANSWER
if ! [[ $ANSWER = "y" ]]; then
	exit 1
fi

SCRIPT_DIR="$(dirname "$(dirname "$(readlink -f "$0")")")"

# IMPORT HELPER FUNCS
source "$SCRIPT_DIR/src/zsh/funcs"

echo "Creating Directory $HOME/.stubbe/"
mkdir -p "$HOME/.stubbe"
ln -s "$SCRIPT_DIR/bin" "$HOME/.stubbe/bin"
ln -s "$SCRIPT_DIR/src" "$HOME/.stubbe/src"

STUBBE_SRC="$HOME/.stubbe/src"

echo "Installing FONTS"
SOURCE_FONT="$STUBBE_SRC/fonts/*.ttf"
mkdir -p "$HOME/.fonts"
ln -s "$SOURCE_FONT" "$HOME/.fonts"

echo "Installing i3 CONFIG"
SOURCE_I3="$STUBBE_SRC/i3/config"
mkdir -p "$HOME/.config/i3"
ln -s "$SOURCE_I3" "$HOME/.config/i3/config"

echo "Installing ZSH CONFIG"
SOURCE_ZSH="$STUBBE_SRC/zsh/init"
touch "$HOME/.zshrc"
if ! has_string "$SOURCE_ZSH" "$HOME/.zshrc"; then
	echo "source $SOURCE_ZSH" >> "$HOME/.zshrc"
fi
eval "source $SOURCE_ZSH"

echo "Installing TMUX CONFIG"
SOURCE_TMUX="$STUBBE_SRC/tmux/tmux.conf"
touch "$HOME/.tmux.conf"
if ! has_string "$SOURCE_TMUX" "$HOME/.tmux.conf"; then
	echo "source-file $SOURCE_TMUX" >> "$HOME/.tmux.conf"
fi
eval "tmux source-file $SOURCE_TMUX"

echo "Installing NEOVIM CONFIG"
SOURCE_NVIM="$STUBBE_SRC/nvim"
mkdir -p "$HOME/.config"
ln -sf "$SOURCE_NVIM" "$HOME/.config/nvim"

echo "All done!"
