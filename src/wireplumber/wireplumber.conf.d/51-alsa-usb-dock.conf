# ALSA configuration for USB docks with KVM switches
# Only apply to USB audio devices (Thunderbolt dock)
# Increased buffers for USB dock through KVM switch to prevent popping

monitor.alsa.rules = [
  {
    matches = [
      {
        api.alsa.card.driver = "USB-Audio"
      }
      {
        alsa.driver_name = "snd_usb_audio"
      }
    ]
    actions = {
      update-props = {
        api.alsa.period-size = 4096
        api.alsa.period-num = 2
        api.alsa.headroom = 8192
        api.alsa.disable-batch = false
        session.suspend-timeout-seconds = 0
        node.pause-on-idle = false
        audio.rate = 48000
        api.alsa.use-chmap = false
        resample.quality = 4
      }
    }
  }
]
