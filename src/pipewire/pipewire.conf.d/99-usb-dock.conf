# Optimized PipeWire configuration for USB docks with KVM switches
# This configuration increases buffer sizes to prevent audio popping/crackling
# when using USB audio devices connected through docking stations and KVM switches.
#
# The larger quantum values (buffer sizes) compensate for:
# - USB communication latency
# - KVM switch electrical noise and timing jitter
# - Additional latency from the dock's USB hub
#
# Quantum size reference:
# - 128 samples @ 48kHz = ~2.7ms (low latency, may cause pops with USB/KVM)
# - 1024 samples @ 48kHz = ~21ms (stable for USB docks, imperceptible for playback)
# - 2048 samples @ 48kHz = ~42ms (maximum stability, use if 1024 still has issues)

# Minimal PipeWire constraints - let browsers negotiate freely
# ALSA hardware buffers (WirePlumber) will prevent popping
context.properties = {
    default.clock.rate = 48000
    # Use PipeWire defaults for quantum - don't override
}

# Stable settings for PulseAudio compatibility layer
# Allow browsers to negotiate their preferred buffer sizes
# ALSA-level buffers (in WirePlumber configs) will prevent popping
pulse.properties = {
    # No minimums - let apps request what they need
}

# Prevent devices from suspending/idling (fixes pops when opening pavucontrol)
stream.properties = {
    node.pause-on-idle = false       # Don't pause streams when idle
    session.suspend-timeout-seconds = 0  # Never suspend
    # Let apps negotiate latency - ALSA buffers provide stability
}
